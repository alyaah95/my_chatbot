<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Assistant - Egypt Info Assistant</title>
    <link rel="stylesheet" href="css/main.css">
</head>

<body>
    <header>
        <div class="container">
            <nav>
                <a href="index.html" class="logo">ðŸ‡ªðŸ‡¬ Egypt Info</a>
                <ul class="nav-links">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="discover.html">Discover</a></li>
                    <li><a href="assistant.html" class="active">Assistant</a></li>
                    <li><a href="about.html">About</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <section class="hero">
        <div class="container">
            <h1>Egypt AI Assistant</h1>
            <p>Ask questions about Egypt's history and geography, and get answers powered by AI</p>
        </div>
    </section>

    <section class="section">
        <div class="container">
            <div class="assistant-container">
                <h2 class="section-title">Ask About Egypt</h2>

                <div class="input-group">
                    <input type="text" id="questionInput" placeholder="Enter your question about Egypt...">
                    <button id="askButton" class="btn">Ask</button>
                </div>

                <div id="answer-area" class="answer-area">
                    <p>Your answer will appear here...</p>
                </div>

                <div class="button-group">
                    <button id="summarizeButton" class="btn btn-secondary hidden">Summarize Answer</button>
                    <button id="showFullAnswerButton" class="btn btn-secondary hidden">Show Full Answer</button>
                </div>
            </div>

            <div class="card-grid">
                <div class="card">
                    <div class="card-content">
                        <h3>Sample Questions</h3>
                        <p>â€¢ What was the main characteristic of the New Kingdom of Egypt, as described in the provided text?</p>
                        <p>â€¢ Which specific cultural and scientific center was established in Egypt during the Fatimid Rule, according to the text?</p>
                        <p>â€¢ Besides the Nile Valley, what is the largest geographical region in Egypt, and what features characterize it?</p>
                        <p>â€¢ What is the primary significance of the Suez Canal in terms of global trade, as mentioned in the geography text?</p>
                    </div>
                </div>

                <div class="card">
                    <div class="card-content">
                        <h3>About Our Assistant</h3>
                        <p>Our AI assistant uses advanced language models to provide accurate information about Egypt's
                            history and geography. It can access detailed information from our knowledge base and
                            provide concise answers to your questions.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <footer>
        <div class="footer-pattern">ð“‚€</div>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>About Egypt Info</h3>
                    <p>Your interactive guide to Egypt's rich history, geography, and cultural heritage. Explore the wonders
                        of ancient and modern Egypt with our AI-powered assistant.</p>
                    <div class="social-links">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
    
                <div class="footer-section">
                    <h3>Quick Links</h3>
                    <ul class="footer-links">
                        <li><a href="index.html">Home</a></li>
                        <li><a href="discover.html">Discover Egypt</a></li>
                        <li><a href="assistant.html">AI Assistant</a></li>
                        <li><a href="about.html">About Us</a></li>
                    </ul>
                </div>
    
                <div class="footer-section">
                    <h3>Explore More</h3>
                    <ul class="footer-links">
                        <li><a href="#">Ancient Pharaohs</a></li>
                        <li><a href="#">Egyptian Mythology</a></li>
                        <li><a href="#">Archaeological Sites</a></li>
                        <li><a href="#">Egyptian Culture</a></li>
                    </ul>
                </div>
    
                <div class="footer-section">
                    <h3>Stay Updated</h3>
                    <p>Subscribe to our newsletter for the latest updates and discoveries about Egypt.</p>
                    <div class="newsletter-form">
                        <input type="email" class="newsletter-input" placeholder="Your email address">
                        <button class="newsletter-btn">Subscribe</button>
                    </div>
                </div>
            </div>
    
            <div class="footer-bottom">
                <p>&copy; 2023 Egypt Info Assistant. All rights reserved. | Designed with â™¥ for Egypt lovers</p>
            </div>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const questionInput = document.getElementById('questionInput');
            const askButton = document.getElementById('askButton');
            const summarizeButton = document.getElementById('summarizeButton');
            const showFullAnswerButton = document.getElementById('showFullAnswerButton');
            const answerArea = document.getElementById('answer-area');

            let currentFullAnswer = "";
            let currentQuery = "";

            const ASK_API_URL = 'http://127.0.0.1:5000/ask';
            const SUMMARIZE_API_URL = 'http://127.0.0.1:5000/summarize';

            askButton.addEventListener('click', async () => {
                const query = questionInput.value.trim();
                if (!query) {
                    answerArea.innerHTML = "<p>Please enter a question.</p>";
                    return;
                }
                currentQuery = query;

                answerArea.innerHTML = "<p>Searching for an answer...</p>";
                askButton.disabled = true;
                summarizeButton.classList.add('hidden');
                showFullAnswerButton.classList.add('hidden');

                try {
                    const response = await fetch(ASK_API_URL, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ query: query })
                    });

                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.answer || 'Server error occurred.');
                    }

                    const data = await response.json();
                    currentFullAnswer = data.answer;
                    answerArea.innerHTML = `<p>${data.answer}</p>`;

                    if (data.answer && data.answer.length > 0) {
                        summarizeButton.classList.remove('hidden');
                    }

                } catch (error) {
                    console.error('Error fetching answer:', error);
                    answerArea.innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
                    summarizeButton.classList.add('hidden');
                } finally {
                    askButton.disabled = false;
                }
            });

            summarizeButton.addEventListener('click', async () => {
                if (!currentFullAnswer) return;

                answerArea.innerHTML = "<p>Summarizing the answer...</p>";
                summarizeButton.disabled = true;
                showFullAnswerButton.classList.add('hidden');

                try {
                    const response = await fetch(SUMMARIZE_API_URL, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ text: currentFullAnswer, question: currentQuery })
                    });

                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.summary || 'Summarization error.');
                    }

                    const data = await response.json();
                    answerArea.innerHTML = `<p>${data.summary}</p>`;

                    summarizeButton.classList.add('hidden');
                    showFullAnswerButton.classList.remove('hidden');

                } catch (error) {
                    console.error('Error summarizing:', error);
                    answerArea.innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
                } finally {
                    summarizeButton.disabled = false;
                }
            });

            showFullAnswerButton.addEventListener('click', () => {
                if (currentFullAnswer) {
                    answerArea.innerHTML = `<p>${currentFullAnswer}</p>`;
                    showFullAnswerButton.classList.add('hidden');
                    summarizeButton.classList.remove('hidden');
                }
            });

            questionInput.addEventListener('keypress', (event) => {
                if (event.key === 'Enter') {
                    askButton.click();
                }
            });
        });
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</body>

</html>